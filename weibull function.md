## Weibull function in behavioral data analysis

以下图片来自于2008年的文章Neural correlates of perceptual learning in a sensorymotor, but not a sensory, cortical area；对公式的解释来源于chatGPT。

![Weibull function](<weibull.png>)

图中的公式是在行为数据分析中使用的时间依赖的累积Weibull函数。Weibull函数是一种常用于描述存活时间数据或反应时间数据的概率分布，尤其是在涉及到生存分析、可靠性分析或心理物理学任务中的表现建模时。这个公式旨在根据时间和刺激强度（例如视觉运动强度）来建模被试的辨别性能。

### 公式解释：

\[
P(C, T) = 0.5 + (0.5 - \lambda) \times \left( 1 - e^{-\left(\frac{C}{\alpha T^n}\right)^\beta} \right)
\]

其中：

- **\(P(C, T)\)** 是辨别性能（discrimination performance），也就是在一定的运动强度 \(C\) 和观看时间 \(T\) 下，被试能够正确辨别刺激的概率。  
- **\(C\)** 是运动强度（motion strength），也可以被理解为感知中的“信号强度”，它通常表示的是刺激的强度（如视觉运动中的百分比相干性，单位为% coherence）。  
- **\(T\)** 是观看时间（viewing time），以秒为单位，表示被试观察刺激的时间长度。  
- **\( \lambda \)** 是一个修正参数，表示被试在高强度（如99%相干性）刺激下的错误率的比例（fraction of errors），其作用是用来调节模型在强刺激下的基线表现。通常 \( \lambda \) 的取值范围为 0 到 0.5。  
- **\( \alpha \)** 是阈值参数（threshold parameter），表示在时间 \(T = 1\) 秒时的阈值运动强度 \(C\)，即达到一定准确率所需的最小运动强度。  
- **\(n\)** 是时间指数（time exponent），它控制时间对阈值的影响。它的值通常反映时间如何影响辨别能力。例如，\(n > 1\) 可能表示更长的观看时间会显著提高辨别性能。  
- **\( \beta \)** 是形状参数（shape parameter），用来调节 Weibull 函数的形状，决定了运动强度如何影响性能的变化速率。  
- **\(e^{-\left(\frac{C}{\alpha T^n}\right)^\beta}\)** 是累积Weibull函数的主要形式。这个项中的指数控制着辨别性能随时间和运动强度的变化。

### 公式的含义：
- **基线性能**：公式中的常数项 0.5 表示的是一个随机猜测的基线辨别性能，通常在双选任务中，50% 准确率相当于随机猜测。  
- **性能增长**：公式中的第二项 \((0.5 - \lambda) \times \left( 1 - e^{-\left(\frac{C}{\alpha T^n}\right)^\beta} \right)\) 描述了当运动强度 \(C\) 和观看时间 \(T\) 增加时，辨别性能如何从基线表现 0.5 提高。  
  - **\((0.5 - \lambda)\)** 调整了表现的最大提升程度，意味着即使在长时间观看和高强度运动情况下，辨别性能也会趋向于一个上限，而不是无限提高。
  - **累积Weibull函数**部分决定了辨别性能的增长方式。Weibull函数是一种S形曲线，随着 \(C\) 和 \(T\) 的增加，辨别性能从基线逐渐接近最大值。

### 参数的取值范围和作用：
1. **\( \alpha \)**：越小表示被试在较低的运动强度下也能进行较好的辨别。通常是正数。
2. **\( n \)**：通常为正数，表示时间对阈值的影响。如果 \( n = 1 \)，阈值与时间成线性关系；如果 \( n > 1 \)，时间的影响更大。
3. **\( \beta \)**：通常为正数，表示曲线的陡峭程度。较大的 \( \beta \) 值意味着辨别性能随着运动强度的提高更快地接近上限。

### 为什么这么建模：
- **Weibull函数的灵活性**：Weibull函数以其广泛的适应性和灵活性著称，能够很好地描述不同时间和强度条件下性能的非线性变化。在心理物理实验中，响应数据往往呈现S型曲线，尤其是随着刺激强度的增加，性能从随机猜测逐渐提升到接近完美水平。Weibull函数能够很好地捕捉到这种变化趋势。  
- **时间依赖**：通过引入 \(T^n\) 项，模型能够反映出辨别性能不仅依赖于刺激强度，还受到观看时间的显著影响。